///////////////////////////////////////////////////////////
//  JobsSlider
//  Backbone Javascript
//  Generated by TextMate
//  Created 2013-06-27
//  Author Ignacio Palladino
//  Copyright (c) 2013 Free Stream Media Corp. All rights reserved.
///////////////////////////////////////////////////////////

Resume.JobsSlider = Backbone.View.extend({    
    template : "jobslider",
    initialize : function () {
        console.log("Resume.initialize, render");
        this._meta = {
            "visibleIndex": 0
        }
        
        this.on("change:visibleIndex", this.onVisibleIndexChange, this);
    },
    events : {
        "click #arrow-left" : "left",
        "click #arrow-right" : "right"
    },

    set : function (prop, value) {
        if(value != this.get(prop)) {
            this._meta[prop] = value;
            this.trigger("change:"+prop);
        }
    },
        
    get : function (prop) {
        return this._meta[prop];
    },
    
    left : function () {
        console.log("JobSlider.left");
        if(this.get("visibleIndex") > 0) {
            this.set("visibleIndex", this.get("visibleIndex")-1)
        }
        this.updateColors();
    },
    right : function () {
        console.log("JobSlider.right, length: " + $("#slides-container .slide").length);
        if(this.get("visibleIndex") < $(this.el).find("#slides-container .slide").length - 1) {
            this.set("visibleIndex", this.get("visibleIndex")+1)
        }
        this.updateColors();
    },
    
    updateColors : function () {
        if(this.get("visibleIndex") < $("#slides-container .slide").length-1) {
            $(".icon-arrow_right").attr("style", "opacity:1;");
        } else {
            $(".icon-arrow_right").attr("style", "opacity:0;");
        }
        
        if(this.get("visibleIndex") > 0) {
            $(".icon-arrow_left").attr("style", "opacity:1;");
        } else {
            $(".icon-arrow_left").attr("style", "opacity:0;");
        }
        
    },

    render : function(){
        console.log("Resume.JobsSlider, render");
        this.setElement("#jobslider");
        var html = JST[this.template]();
        $(this.el).html(html);
        this.updateColors();
    },
    
    onVisibleIndexChange : function () {
        console.log("Resume.onVisibleIndexChange");
        $(".slide:eq(0)").css({"margin-left":String(-15*this.get("visibleIndex"))+"%"});
         
    },

});